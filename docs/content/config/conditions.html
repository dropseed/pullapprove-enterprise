{% extends "base.template.html" %}

{% set title = "Conditions" %}

{% block content %}

<h1>Conditions</h1>

<p>Conditions are how you decide when a group should be asked to look at a PR.
Often times, people will set this up based on specific filetypes or languages.
The same data and syntax also powers the <a
href="/config/pullapprove-conditions/">pullapprove_conditions</a> and <a
href="/config/notifications/">notification filters</a>.</p>

<h3>Things to know</h3>
<ul class="list-disc pl-8 mb-4">
  <li>Every condition in the list must be true to activate the group</li>
  <li>If you need to "or" a condition, do it in a single list item with the word "or"</li>
  <li>Conditions must be strings (almost always need to be surrounded by quotes to be proper YAML)</li>
</ul>

<p>Under the hood, conditions are evaluated as Python. There is a specific set
of functions that you can use and variables you have access to. This allows you
to write flexible, powerful "if" statements while still being readable. Note
that in Python, some operators are written as more readable words, such as "in",
"not in", "and", and, "or".</p>

<h2>Examples</h2>

<h3>Comparing objects</h3>

{% code "yaml" %}
conditions:
- "'bug' in labels"
- "'sig-*' in labels"
- "regex('.*/app') in labels"
- "'*.py' in files or '*.js' in files"
- "'*travis*' in statuses.succeeded"
- "base.ref == 'master'"
- "base.ref != base.repo.default_branch"
- "not mergeable"
- "created_at < date('3 days ago')"
{% endcode %}

<h3>Comparing strings</h3>

<p>For variables that are simply strings, you'll need to use specific functions
to compare with regular expressions or fnmatch syntax.</p>

{% code "yaml" %}
conditions:
- "'WIP' in title"  # checks for 'WIP' anywhere in the string
- "contains_fnmatch(title, 'WIP*')"
- "contains_regex(title, 'WIP: .*')"
- "'feature' in head.ref"
- "contains_fnmatch(head.ref, 'feature*')"
{% endcode %}

<h3>Files and Paths</h3>

<p>Often times reviewers are decided by the changes made in a PR. You can use
<code>include</code> and <code>exclude</code> to build more complex rules for
who needs to review what changes.</p>

{% code "yaml" %}
conditions:
# review any changes in src unless they only involved markdown
- "files.include('src/*').exclude('*.md')"
# review changes to any non-python tests
- "files.include('*test*').exclude('*.py')"
{% endcode %}

<h3>Multiline conditions for readability</h3>

<p>If you want to "OR" many conditions, it can be easier on the eyes to break it into multiple lines using the <a href="https://yaml-multiline.info/">YAML multiline syntax</a>.</p>

{% code "yaml" %}
conditions:
- >
  '*.md' in files or
  '*.py' in files or
  'test_*' in files
{% endcode %}


<h2>Context reference</h2>

<p>The following variables are directly available when writing conditions and
templates. For variables that are custom objects, see their properties further
down the page.</p>

<p>Don't see what you need? <a href="/contact/">Let us know.</a></p>

{% include "config/_generated_context.html" %}

{% endblock %}
